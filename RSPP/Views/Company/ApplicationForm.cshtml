@model RSPP.Models.DB.ApplicationRequestForm
@{
    ViewData["Title"] = "Application Form";
    Layout = "~/Views/Shared/_ClientLayout.cshtml";
}

<br />
<div class="row" style="height: 10%">
    <div class="pageTitle bg1" style="background: url('/images/bgblue11.jpg'); width: 100%; background-repeat:no-repeat; background-size:cover ">
        <h2>Application Form</h2>
        <div class="clear"></div>
    </div>
</div>

<div class="padd-t form-horizontal">

    @using (Html.BeginForm("ApplicationForm", "Company", FormMethod.Post, new { id = "formid", role = "form", @class = "form-horizontal" }))
    {
        @Html.AntiForgeryToken()
        @Html.ValidationSummary(true)
        @Html.HiddenFor(model => model.ApplicationTypeId)
        @Html.HiddenFor(model => model.Status)
        @Html.HiddenFor(model => model.AgencyName)







        <div class="form-group">



            <div class="row form-group">
                <label class="control-label col-md-2">Application Type</label>
                <div class="col-md-4">
                    <select class="form-control" required="required" id="AppType" name="AppType">
                        <option></option>
                        <option>NEW</option>
                        <option>RENEW</option>
                    </select>
                </div>
            </div>

            <div style="display:none" id="hidecertnum">
                <div class="row form-group">
                    <label class="control-label col-md-2">Renewal Certificate Number </label>
                    <div class="col-md-4">
                        <select class="form-control txtcertnum" id="txtcertnum" name="txtcertnum"></select>
                    </div>
                </div>
            </div>



            <div class="row form-group">
                <label class="control-label col-md-2">Agencies</label>
                <div class="col-md-4">
                    <select class="form-control agency" required="required" id="txtagency" name="txtagency"></select>
                </div>
            </div>

            <div class="row form-group">
                <label class="control-label col-md-2">Date of Establishment(with CAC)</label>
                <div class="col-md-4">
                    @Html.TextBoxFor(model => model.ApplicationId, new { @type = "hidden", @value = ViewBag.ApplicationId })
                    @Html.TextBoxFor(model => model.DateofEstablishment, new { @class = "form-control", required = "required", @readonly = "readonly" })
                </div>


                <label class="control-label col-md-2">Company Address</label>
                <div class="col-md-4">
                    @Html.TextBoxFor(model => model.CompanyAddress, new { @class = "form-control CompanyAddress", required = "required" })
                </div>
            </div>



            <div class="row form-group">
                <label class="control-label col-md-2">Postal Address</label>
                <div class="col-md-4">
                    @Html.TextBoxFor(model => model.PostalAddress, new { @class = "form-control", required = "required" })
                </div>


                <label class="control-label col-md-2">Phone Number</label>
                <div class="col-md-4">
                    @Html.TextBoxFor(model => model.PhoneNum, new { @class = "form-control PhoneNum", required = "required" })
                </div>
            </div>




            <div class="row form-group">
                <label class="control-label col-md-2">Company Email</label>
                <div class="col-md-4">
                    @Html.TextBoxFor(model => model.CompanyEmail, new { @class = "form-control", required = "required", @type = "email", @readonly = "readonly" })
                </div>


                <label class="control-label col-md-2">Company Website</label>
                <div class="col-md-4">
                    @Html.TextBoxFor(model => model.CompanyWebsite, new { @class = "form-control CompanyWebsite", required = "required" })
                </div>
            </div>




            <div id="Agencyid1" style="display:none">
                <div class="row form-group">
                    <label class="control-label col-md-2">Services Provided In Port</label>
                    <div class="col-md-4">
                        <textarea class="form-control" id="ServicesProvidedInPort" name="ServicesProvidedInPort" cols="3" rows="3">@ViewBag.ServicesProvidedInPort</textarea>
                    </div>


                    <label class="control-label col-md-2">Any Other Relevant Info</label>
                    <div class="col-md-4">
                        <textarea class="form-control" id="AnyOtherRelevantInfo" name="AnyOtherRelevantInfo" cols="3" rows="3">@ViewBag.AnyOtherRelevantInfo</textarea>

                    </div>
                </div>
            </div>

            <div id="Agencyid2" style="display:none">
                <div class="row form-group">
                    <label class="control-label col-md-2">Line Of Business</label>
                    <div class="col-md-9">
                        <input type="checkbox" class="Logistics" id="CargoConsolidators" name="CargoConsolidators" value="Cargo Consolidators"><b> Cargo Consolidators</b>
                        <input type="checkbox" class="Logistics" id="Chandling" name="Chandling" value="Chandling"> <b>Chandling</b>
                        <input type="checkbox" class="Logistics" id="ClearingAgents" name="ClearingAgents" value="Clearing Agents"> <b>Clearing Agents</b>
                        <input type="checkbox" class="Logistics" id="FreightForwarding" name="FreightForwarding" value="Freight Forwarding"><b> Freight Forwarding</b>
                        <input type="checkbox" class="Logistics" id="RoadHaulage" name="RoadHaulage" value="Road Haulage"> <b>Road Haulage</b>
                        <input type="checkbox" class="Logistics" id="Stevedoring" name="Stevedoring" value="Stevedoring"> <b>Stevedoring</b>
                        <input type="checkbox" class="Logistics" id="Warehousing" name="Warehousing" value="Warehousing"> <b>Warehousing</b>
                        <input type="checkbox" class="Logistics" id="LogisticsOthers" name="LogisticsOthers" value="LogisticsOthers"> <b>Others</b>


                    </div>
                    <div class="col-md-10">
                        <textarea class="form-control" id="LogisticsLineOfBusiness" style="display:none;margin-left:230px" name="LogisticsLineOfBusiness">@ViewBag.LineOfBusiness</textarea>
                    </div>

                </div>




                <div class="row form-group">
                    <label class="control-label col-md-2">Customs License Number</label>
                    <div class="col-md-4">
                        <input type="text" class="form-control" id="CustomLicenseNum" name="CustomLicenseNum" />
                    </div>


                    <label class="control-label col-md-2">Customs License Expiry Date</label>
                    <div class="col-md-4">
                        <input type="text" class="form-control" readonly id="CustomLicenseExpiryDate" name="CustomLicenseExpiryDate" />

                    </div>
                </div>


                <div class="row form-group">
                    <label class="control-label col-md-2">CRFFN Registration Number</label>
                    <div class="col-md-4">
                        <input type="text" class="form-control" id="CrffnRegistrationNum" name="CrffnRegistrationNum" />
                    </div>


                    <label class="control-label col-md-2">CRFFN Registration Expiry Date</label>
                    <div class="col-md-4">
                        <input type="text" class="form-control" readonly id="CrffnRegistratonExpiryDate" name="CrffnRegistratonExpiryDate" />

                    </div>
                </div>


                <div class="row form-group">
                    <label class="control-label col-md-2">Other License/Certification Number</label>
                    <div class="col-md-4">
                        <input type="text" class="form-control" id="OtherLicense" name="OtherLicense" />
                    </div>


                    <label class="control-label col-md-2">Other License/Certification Expiry Date</label>
                    <div class="col-md-4">
                        <input type="text" class="form-control" id="OtherLicenseExpiryDate" readonly name="OtherLicenseExpiryDate" />

                    </div>
                </div>


                <div class="row form-group">
                    <label class="control-label col-md-2">Any Other Relevant Info</label>
                    <div class="col-md-4">
                        <textarea class="form-control" id="LogisticsAnyOtherRelevantInfo" name="LogisticsAnyOtherRelevantInfo" cols="3" rows="3">@ViewBag.AnyOtherRelevantInfo</textarea>

                    </div>
                </div>
            </div>



            <div id="Agencyid3" style="display:none">
                <div class="row form-group" style="font-size:12px">

                    <div class="col-md-4">
                        <b>Line Of Business</b>
                        <input type="checkbox" class="LineOfBusinessTerminals" id="PortTerminal" name="PortTerminal" value="Port Terminal"> Port Terminal
                        <input type="checkbox" class="LineOfBusinessTerminals" id="OffDockTerminal" name="OffDockTerminal" value="Off Dock Terminal"> Off Dock Terminal
                        <input type="checkbox" class="LineOfBusinessTerminals" id="ClearingAgents" name="DryPort" value="Dry Port"> Dry Port
                        <textarea type="text" class="form-control" style="display:none" id="portoffdockLineOfBusiness" name="portoffdockLineOfBusiness">@ViewBag.portoffdockLineOfBusiness</textarea>

                    </div>

                    <div class="col-md-4">
                        <b>Status of Terminal:</b>
                        <input type="checkbox" class="StatusTerminals" id="PortTerminal" name="PortTerminal" value="Port Terminal"> Port Terminal
                        <input type="checkbox" class="StatusTerminals" id="OffDockTerminal" name="OffDockTerminal" value="Off Dock Terminal"> Off Dock Terminal
                        <input type="checkbox" class="StatusTerminals" id="ClearingAgents" name="DryPort" value="Dry Port"> Dry Port
                        <input type="checkbox" class="StatusTerminals" id="OtherStatusTerminal" name="OtherStatusTerminal" value="StatusTerminalOthers"> Others

                        <textarea type="text" class="form-control" style="display:none" id="StatusOfTerminal" name="StatusOfTerminal">@ViewBag.StatusOfTerminal</textarea>


                    </div>

                    <div class="col-md-4">
                        <b>Cargo Type:</b>
                        <input type="checkbox" class="CargoTypeTerminals" id="CargoTypeBulk" name="CargoTypeBulk" value="Bulk"> Bulk
                        <input type="checkbox" class="CargoTypeTerminals" id="CargoTypeContainer" name="CargoTypeContainer" value="Container"> Container
                        <input type="checkbox" class="CargoTypeTerminals" id="CargoTypeDry" name="CargoTypeDry" value="Dry"> Dry
                        <input type="checkbox" class="CargoTypeTerminals" id="CargoTypeRoRo" name="CargoTypeRoRo" value="Ro-Ro"> Ro-Ro
                        <input type="checkbox" class="CargoTypeTerminals" id="CargoTypeWet" name="CargoTypeWet" value="Wet"> Wet
                        <input type="checkbox" class="CargoTypeTerminals" id="CargoTypeOthers" name="CargoTypeOthers" value="CargoTypeOthers"> Others
                        <textarea type="text" class="form-control" style="display:none" id="portoffdockCargoType" name="portoffdockCargoType">@ViewBag.portoffdockCargoType</textarea>



                    </div>

                </div>


                @*<div class="row" style="margin-left:5px; margin-right:5px">
                    <div class="col-md-12" style="min-width:100%">class="table table-condensed table-bordered table-striped table-hover table-responsive" id="mytable"*@
                <table class="table table-bordered table-striped" id="mytable" style="width:100%">

                    <thead>
                        <tr>
                            <th> Terminal Name</th>
                            <th>
                                Terminal Location <span style="float:right" class="btn btn-success btn-sm" id="btnAddMoreTerminal" onclick="AddTerminal()"> <i class="fa fa-plus"> </i> Add More Terminal </span>
                            </th>
                            <th style="width:5px"></th>
                        </tr>
                    </thead>

                    <tbody id="AppendTerminals" style="width:100%">

                        <tr>
                            <td>
                                <input type="text" required class="form-control" placeholder="Enter Terminal Name" id="txtTerminalName[]" name="txtTerminalName[]" />
                            </td>

                            <td>
                                <input type="text" required class="form-control txtTerminalLocation" id="txtTerminalLocation[]" name="txtTerminalLocation[]" />
                            </td>
                        </tr>



                    </tbody>

                </table>
                @*</div>

                    </div>*@

                <div class="row form-group">
                    <label class="control-label col-md-1">Any Other Relevant Info</label>
                    <div class="col-md-11">
                        <textarea class="form-control" id="portoffdockAnyOtherInfo" name="portoffdockAnyOtherInfo" cols="2" rows="2">@ViewBag.portoffdockAnyOtherInfo</textarea>
                    </div>
                </div>
            </div>


            <div id="Agencyid4" style="display:none">
                <div class="row form-group">
                    <label class="control-label col-md-2"></label>
                    <div class="col-md-4">
                        <b>Line Of Business:</b>
                        <input type="checkbox" class="LineOfBusinessShipping" id="ShippingAgency" name="ShippingAgency" value="Shipping Agency"> Shipping Agency
                        <input type="checkbox" class="LineOfBusinessShipping" id="ShippingCompany" name="ShippingCompany" value="Shipping Company/Line"> Shipping Company/Line
                        <input type="text" class="form-control" style="display:none" id="ShippingagencyLineOfBusiness" value="@ViewBag.LineOfBusiness" name="ShippingagencyLineOfBusiness" />
                    </div>
                    <div class="col-md-4">
                        <b>Cargo Type</b>
                        <input type="checkbox" class="ShippingCargoType" id="ShippingCargoTypeBulk" name="ShippingCargoTypeBulk" value="Bulk"> Bulk
                        <input type="checkbox" class="ShippingCargoType" id="ShippingCargoTypeContainer" name="ShippingCargoTypeContainer" value="Container"> Container
                        <input type="checkbox" class="ShippingCargoType" id="ShippingCargoTypeDry" name="ShippingCargoTypeDry" value="Dry"> Dry
                        <input type="checkbox" class="ShippingCargoType" id="ShippingCargoTypeRoRo" name="ShippingCargoTypeRoRo" value="Ro-Ro"> Ro-Ro
                        <input type="checkbox" class="ShippingCargoType" id="ShippingCargoTypeWet" name="ShippingCargoTypeWet" value="Wet"> Wet
                        <input type="checkbox" class="ShippingCargoType" id="ShippingCargoTypeOthers" name="ShippingCargoTypeOthers" value="ShippingCargoTypeOthers"> Others
                        <textarea type="text" class="form-control" id="ShippingagencyCargoType" style="display:none" name="ShippingagencyCargoType">@ViewBag.ShippingagencyCargoType</textarea>
                    </div>
                </div>


                <div class="row form-group">
                    <label class="control-label col-md-2">Vessel/Lines Represented in Nigeria</label>
                    <div class="col-md-4">
                        <textarea class="form-control" id="VesselLinesRepresentedInNigeria" name="VesselLinesRepresentedInNigeria" cols="3" rows="3">@ViewBag.VesselLinesRepresentedInNigeria</textarea>
                    </div>

                    <label class="control-label col-md-2">Any Other Relevant Info</label>
                    <div class="col-md-4">
                        <textarea class="form-control" id="ShippingagencyAnyOtherInfo" name="ShippingagencyAnyOtherInfo" cols="3" rows="3">@ViewBag.ShippingagencyAnyOtherInfo</textarea>
                    </div>

                </div>

            </div>

            <div id="Agencyid5" style="display:none">
                <div class="row form-group">
                    <label class="control-label col-md-2">Line of Business</label>
                    <div class="col-md-4">
                        <textarea class="form-control" id="otherportLineOfBusiness" name="otherportLineOfBusiness" cols="3" rows="3">@ViewBag.otherportLineOfBusiness</textarea>
                    </div>

                    <label class="control-label col-md-2">Any Other Relevant Info</label>
                    <div class="col-md-4">
                        <textarea class="form-control" id="otherportAnyOtherInfo" name="otherportAnyOtherInfo" cols="3" rows="3">@ViewBag.otherportAnyOtherInfo</textarea>
                    </div>

                </div>
            </div>


            <br />
            <div class="col-xs-12 col-md-offset-12 text-md-center">
                <button type="submit" class="btn btn-primary btn-default round" id="addbtn">Submit and Continue</button>
            </div>

        </div>
    }
</div>
<div style="display:none" id="loadingImage" class="loadingImage">
    <div id="load" style="width: 100%; height: 100%; top:0; left:0; position:fixed; display:block; opacity:0.7; background-color:#fff; z-index:99; text-align:center">
        <img id="loading-image" style="position:absolute; top:100px; left:50%; z-index:100" src="~/images/spinning.gif" />
    </div>
</div>
<div id="modalMapDialog" style="display: none">
    <div id="MapContainer" style="height: 430px; width: 100%;border: 5px solid green;"></div>
</div>


@section scripts{
    <script src="~/js/jquery-3.3.1.js"></script>
    <script src="~/js/jquery.validate.min.js"></script>
    <script src="~/js/bootstrap.min.js"></script>

    <script src="~/js/jquery.ui.widget.js"></script>
    <script src="~/js/jquery.iframe-transport.js"></script>
    <script src="~/js/select2.min.js"></script>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC2df9i_A809q2eQQizBb7UqSGXASsQHVQ&libraries=places"></script>
    <script src="~/js/jquery-ui.min.js"></script>



    <script type="text/javascript">

        function getContextPath() {
            return window.location.pathname.substring(0, window.location.pathname.indexOf("/", 2));
        }

        function getPlace() {
            google.maps.event.addDomListener(window, 'load', function () {
                var options = {
                    componentRestrictions: { country: "ng" }
                };
                debugger;
                var places = null;
                var input = document.getElementsByClassName('txtTerminalLocation');
                for (i = 0; i < input.length; i++) {
                    places = new google.maps.places.Autocomplete(input[i], options);
                }
                var places = new google.maps.places.Autocomplete(document.getElementById('PostalAddress'), options);
                places = new google.maps.places.Autocomplete(document.getElementById('CompanyAddress'), options);
                google.maps.event.addListener(places, 'place_changed', function () {
                    var place = places.getPlace();
                    var address = place.formatted_address;
                    var latitude = place.geometry.location.lat();
                    var longitude = place.geometry.location.lng();
                    var mesg = "Location Address Is : " + address;
                    mesg += "\nLocation Latitude Is : " + latitude;
                    mesg += "\nLocation Longitude Is: " + longitude;
                    showMap(address, latitude, longitude);
                });
            });
        }


        function showMap(locationaddress, latitude, longitude) {
            var markers = [];

            $("#modalMapDialog").dialog({
                modal: true,
                title: "Address Location on Map",
                width: 550,
                hright: 400,
                buttons: {
                    Close: function () {
                        $(this).dialog('close');
                    },
                    Okay: function () {
                        //$('#secondDiv').show();
                        $("#GPS").val(latitude + ',' + longitude);
                        $(this).dialog('close');
                    }
                },
                open: function () {

                    google.maps.visualRefresh = true;
                    var myCenter = new google.maps.LatLng(latitude, longitude);
                    var mapCanvas = document.getElementById("MapContainer");
                    var mapOptions = {
                        center: myCenter,
                        zoom: 14,
                        mapTypeId: google.maps.MapTypeId.ROADMAP,
                        panControl: true,
                        zoomControl: true,
                        mapTypeControl: true,
                        scaleControl: true,
                        streetViewControl: true,
                        overviewMapControl: true,
                        rotateControl: true,
                        zoomControl: true,
                        zoomControlOptions: {
                            style: google.maps.ZoomControlStyle.SMALL
                        },
                        mapTypeControl: true,
                        mapTypeControlOptions: {
                            style: google.maps.MapTypeControlStyle.DROPDOWN_MENU,
                            position: google.maps.ControlPosition.TOP_CENTER,
                            mapTypeIds: [
                                google.maps.MapTypeId.ROADMAP,
                                google.maps.MapTypeId.TERRAIN,
                                google.maps.MapTypeId.SATELLITE,
                                google.maps.MapTypeId.HYBRID
                            ]
                        }
                    };

                    var map = new google.maps.Map(mapCanvas, mapOptions);
                    var marker = new google.maps.Marker({ position: myCenter, animation: google.maps.Animation.BOUNCE });
                    marker.setMap(map);

                    var infowindow = new google.maps.InfoWindow({
                        content: locationaddress
                    });
                    infowindow.open(map, marker);

                    // Zoom to 9 when clicking on marker
                    google.maps.event.addListener(marker, 'click', function () {
                        map.setZoom(13);
                        map.setCenter(marker.getPosition());
                    });
                }
            });
        }

        var Terminals_i = 50;

        function AddTerminal() {
            debugger
            Terminals_i++;

            var html = "<tr style='width:100%' id='Remove" + Terminals_i + "'>  <td> <input type='text' placeholder='Enter Terminal Name' required class='form-control' id='txtTerminalName[]' name='txtTerminalName[]' /> </td>";
            html += "<td> <input type='text' class='form-control txtTerminalLocation' id='txtTerminalLocation[]'required name='txtTerminalLocation[]' /> </td>";
            html += " <td> <button class='btn btn-danger btn-xs' onclick='RemoveTerminal();'> <span class='glyphicon glyphicon-trash'> </span>  Delete</button> </td> </tr>";
            $("#AppendTerminals tr:last").after(html);

            var options = {
                componentRestrictions: { country: "ng" }
            };
            debugger;
            var places = null;
            var input = document.getElementsByClassName('txtTerminalLocation');
            for (i = 0; i < input.length; i++) {
                places = new google.maps.places.Autocomplete(input[i], options);
            }
            google.maps.event.addListener(places, 'place_changed', function () {
                var place = places.getPlace();
                var address = place.formatted_address;
                var latitude = place.geometry.location.lat();
                var longitude = place.geometry.location.lng();
                var mesg = "Location Address Is : " + address;
                mesg += "\nLocation Latitude Is : " + latitude;
                mesg += "\nLocation Longitude Is: " + longitude;
                showMap(address, latitude, longitude);
            });


        }
        function RemoveTerminal() {
            $("#Remove" + Terminals_i).remove();
            Terminals_i--;
        }





        $(document).ready(function () {

            getPlace();
            $("#CompanyEmail").val('@ViewBag.AgencyEmail');

            $("#AppType").change(function () {
                var selectedvalue = $("#AppType option:selected").text();

                if (selectedvalue === "RENEW") {
                    $("#ApplicationTypeId").val('RENEW');
                    $("#hidecertnum").show();
                    $("#txtcertnum").attr("required", true);
                } else {
                    $("#ApplicationTypeId").val('NEW');
                    $("#hidecertnum").hide();
                    $("#txtcertnum").attr("required", false);
                }
            });


            $("#txtcertnum").change(function () {

                var selectedvalue = $("#txtcertnum option:selected").text();

                $.post("/Company/CertificateRenewal", { "CertificateNumber": selectedvalue }, function (response) {

                    if (response != null) {
                        $("#txtagency").html("");

                        $.each(response, function (key, data) {
                            if (data.agencyId === 1) {
                                $("#txtagency").append('<option value="' + data.agencyName + '">' + data.agencyName + '</option>');
                                $("#DateofEstablishment").val(data.dateofEstablishment);
                                $("#CompanyAddress").val(data.companyAddress);
                                $("#PostalAddress").val(data.postalAddress);
                                $("#PhoneNum").val(data.phoneNum);
                                $("#CompanyEmail").val(data.companyEmail);
                                $("#CompanyWebsite").val(data.companyWebsite);
                                $("#ServicesProvidedInPort").val(data.servicesProvidedInPort);
                                $("#AnyOtherRelevantInfo").val(data.anyOtherRelevantInfo);


                            } else if (data.agencyId === 2) {

                                $("#txtagency").append('<option value="' + data.agencyName + '">' + data.agencyName + '</option>');
                                $("#DateofEstablishment").val(data.dateofEstablishment);
                                $("#CompanyAddress").val(data.companyAddress);
                                $("#PostalAddress").val(data.postalAddress);
                                $("#PhoneNum").val(data.phoneNum);
                                $("#CompanyEmail").val(data.companyEmail);
                                $("#CompanyWebsite").val(data.companyWebsite);
                                $("#LogisticsLineOfBusiness").val(data.logisticsLineOfBusiness);
                                $("#CustomLicenseNum").val(data.customLicenseNum);
                                $("#CustomLicenseExpiryDate").val(data.customLicenseExpiryDate);
                                $("#CrffnRegistrationNum").val(data.crffnRegistrationNum);
                                $("#CrffnRegistratonExpiryDate").val(data.crffnRegistratonExpiryDate);
                                $("#OtherLicense").val(data.otherLicense);
                                $("#OtherLicenseExpiryDate").val(data.otherLicenseExpiryDate);
                                $("#LogisticsAnyOtherRelevantInfo").val(data.anyOtherInfo);


                            } else if (data.agencyId === 3) {
                                $("#txtagency").append('<option value="' + data.agencyName + '">' + data.agencyName + '</option>');
                                $("#DateofEstablishment").val(data.dateofEstablishment);
                                $("#CompanyAddress").val(data.companyAddress);
                                $("#PostalAddress").val(data.postalAddress);
                                $("#PhoneNum").val(data.phoneNum);
                                $("#CompanyEmail").val(data.companyEmail);
                                $("#CompanyWebsite").val(data.companyWebsite);
                                $("#portoffdockLineOfBusiness").val(data.lineOfBusiness);
                                $("#StatusOfTerminal").val(data.statusOfTerminal);
                                $("#portoffdockCargoType").val(data.cargoType);
                                $("#portoffdockAnyOtherInfo").val(data.anyOtherInfo);
                                $.each(val.Tanks, function (keys, vals) {
                                    html += "<tr><td>" + vals.nameOfTerminal + "</td> <td>" + vals.locationOfTerminal + "</td></tr>";
                                });
                                $("#AppendTerminals").html(html);

                            } else if (data.agencyId === 4) {
                                $("#txtagency").append('<option value="' + data.agencyName + '">' + data.agencyName + '</option>');
                                $("#DateofEstablishment").val(data.dateofEstablishment);
                                $("#CompanyAddress").val(data.companyAddress);
                                $("#PostalAddress").val(data.postalAddress);
                                $("#PhoneNum").val(data.phoneNum);
                                $("#CompanyEmail").val(data.companyEmail);
                                $("#CompanyWebsite").val(data.companyWebsite);
                                $("#ShippingagencyCargoType").val(data.cargoType);
                                $("#ShippingagencyLineOfBusiness").val(data.lineOfBusiness);
                                $("#VesselLinesRepresentedInNigeria").val(data.vesselLinesRepresentedInNigeria);
                                $("#ShippingagencyAnyOtherInfo").val(data.anyOtherInfo);
                                
                            } else if (data.agencyId === 5) {

                                $("#txtagency").append('<option value="' + data.agencyName + '">' + data.agencyName + '</option>');
                                $("#DateofEstablishment").val(data.dateofEstablishment);
                                $("#CompanyAddress").val(data.companyAddress);
                                $("#PostalAddress").val(data.postalAddress);
                                $("#PhoneNum").val(data.phoneNum);
                                $("#CompanyEmail").val(data.companyEmail);
                                $("#CompanyWebsite").val(data.companyWebsite);
                                $("#otherportLineOfBusiness").val(data.lineOfBusiness);
                                $("#otherportAnyOtherInfo").val(data.anyOtherInfo);
                            }
                        });
                    };
                });
            });




            $(".txtcertnum").ready(function () {//get all Suitability Rference Number in the dropdownlist
                var html = "";
                $(".txtcertnum").html("");

                $.post("/Company/GetCertificateNumber",
                    {},
                    function (datas) {
                        debugger;
                        $(".txtcertnum").append("<option></option>");
                        $.each(datas, function (key, val) {
                            html += "<option value=" + val.licenseReference + ">" + val.licenseReference + "</option>";
                        });
                        $(".txtcertnum").append(html);
                    });
            });





            $(".agency").ready(function () {//get all Suitability Rference Number in the dropdownlist
                var html = "";
                $(".agency").html("");

                $.getJSON("/Company/GetAllAgencies",
                    {},
                    function (datas) {
                        debugger;
                        $(".agency").append("<option></option>");
                        $.each(datas, function (key, val) {
                            html += "<option value=" + val.agencyId + ">" + val.agencyName + "</option>";
                        });
                        $(".agency").append(html);
                    });
            });





            var agencyID = 0;


            $(".agency").on("change", function () {
                debugger;
                agencyID = Number($("#txtagency option:selected").val());
                agencyname = $("#txtagency option:selected").text();
                $("#AgencyName").val(agencyname);
                if (agencyID === 1) {
                    $("#Agencyid1").show();
                    $("#Agencyid2").hide();
                    $("#Agencyid3").hide();
                    $("#Agencyid4").hide();
                    $("#Agencyid5").hide();
                    $("#ServicesProvidedInPort").attr("required", true);

                    $("#CustomLicenseNum").attr("required", false);
                    $("#CustomLicenseExpiryDate").attr("required", false);
                    $("#CrffnRegistrationNum").attr("required", false);
                    $("#CrffnRegistratonExpiryDate").attr("required", false);
                    $("#VesselLinesRepresentedInNigeria").attr("required", false);
                    $("#otherportLineOfBusiness").attr("required", false);
                } else if (agencyID === 2) {
                    $("#Agencyid1").hide();
                    $("#Agencyid2").show();
                    $("#Agencyid3").hide();
                    $("#Agencyid4").hide();
                    $("#Agencyid5").hide();
                    $("#CustomLicenseNum").attr("required", true);
                    $("#CustomLicenseExpiryDate").attr("required", true);
                    $("#CrffnRegistrationNum").attr("required", true);
                    $("#CrffnRegistratonExpiryDate").attr("required", true);

                    $("#ServicesProvidedInPort").attr("required", false);
                    $("#VesselLinesRepresentedInNigeria").attr("required", false);
                    $("#otherportLineOfBusiness").attr("required", false);


                }

                else if (agencyID === 3) {
                    $("#Agencyid1").hide();
                    $("#Agencyid2").hide();
                    $("#Agencyid3").show();
                    $("#Agencyid4").hide();
                    $("#Agencyid5").hide();

                 }

                else if (agencyID === 4) {
                    $("#Agencyid1").hide();
                    $("#Agencyid2").hide();
                    $("#Agencyid3").hide();
                    $("#Agencyid4").show();
                    $("#Agencyid5").hide();
                    $("#VesselLinesRepresentedInNigeria").attr("required", true);

                    $("#CustomLicenseNum").attr("required", false);
                    $("#CustomLicenseExpiryDate").attr("required", false);
                    $("#CrffnRegistrationNum").attr("required", false);
                    $("#CrffnRegistratonExpiryDate").attr("required", false);
                    $("#ServicesProvidedInPort").attr("required", false);
                    $("#otherportLineOfBusiness").attr("required", false);

                }
                else if (agencyID === 5) {

                    $("#Agencyid1").hide();
                    $("#Agencyid2").hide();
                    $("#Agencyid3").hide();
                    $("#Agencyid4").hide();
                    $("#Agencyid5").show();

                    $("#otherportLineOfBusiness").attr("required", true);

                    $("#VesselLinesRepresentedInNigeria").attr("required", false);
                    $("#CustomLicenseNum").attr("required", false);
                    $("#CustomLicenseExpiryDate").attr("required", false);
                    $("#CrffnRegistrationNum").attr("required", false);
                    $("#CrffnRegistratonExpiryDate").attr("required", false);
                    $("#ServicesProvidedInPort").attr("required", false);
                }

            });



            $("#CustomLicenseExpiryDate, #CrffnRegistratonExpiryDate, #OtherLicenseExpiryDate").datepicker({
                "onSelect": function (date) {
                }, changeMonth: true, changeYear: true, dateFormat: "d M yy"
            });


            $(".Logistics").on("change", function () {
                debugger;
                var logistic = $(".Logistics:checked").val();


                var logisticlist = [];




                if (logistic === "LogisticsOthers") {
                    $("#LogisticsLineOfBusiness").show();
                    $("#LogisticsLineOfBusiness").attr("required", true);
                } else {
                    $("#LogisticsLineOfBusiness").hide();
                    $.each($(".Logistics:checked"), function () {
                        logisticlist.push($(this).val());
                    });
                    $("#LogisticsLineOfBusiness").val(logisticlist.join(", "));
                }
            });



            $(".LineOfBusinessTerminals").on("change", function () {

                debugger;
                var LineOfBusinessTerminalslist = [];
                $.each($(".LineOfBusinessTerminals:checked"), function () {
                    LineOfBusinessTerminalslist.push($(this).val());
                });
                $("#portoffdockLineOfBusiness").val(LineOfBusinessTerminalslist.join(", "));

            });


            $(".StatusTerminals").on("change", function () {
                debugger;
                var StatusTerminal = $(".StatusTerminals:checked").val();
                var StatusTerminallist = [];

                if (StatusTerminal === "StatusTerminalOthers") {
                    $("#StatusOfTerminal").show();
                    $("#StatusOfTerminal").attr("required", true);
                } else {
                    $("#StatusOfTerminal").hide();
                    $.each($(".StatusTerminals:checked"), function () {
                        StatusTerminallist.push($(this).val());
                    });
                    $("#StatusOfTerminal").val(StatusTerminallist.join(", "));
                }
            });

            $(".CargoTypeTerminals").on("change", function () {
                debugger;
                var CargoTypeTerminallist = [];
                var CargoTypeTerminal = $(".CargoTypeTerminals:checked").val();
                if (CargoTypeTerminal === "CargoTypeOthers") {
                    $("#portoffdockCargoType").show();
                    $("#portoffdockCargoType").attr("required", true);
                } else {

                    $("#portoffdockCargoType").hide();
                    $.each($(".CargoTypeTerminals:checked"), function () {
                        CargoTypeTerminallist.push($(this).val());
                    });
                    $("#portoffdockCargoType").val(CargoTypeTerminallist.join(", "));
                }
            });



            $(".LineOfBusinessShipping").on("change", function () {
                var portoffdocklist = [];
                $.each($(".LineOfBusinessShipping:checked"), function () {
                    portoffdocklist.push($(this).val());
                });
                $("#ShippingagencyLineOfBusiness").val(portoffdocklist.join(", "));

            });


            $(".ShippingCargoType").on("change", function () {
                debugger;
                var ShippingCargoTypelist = [];
                var ShippingCargoType = $(".ShippingCargoType:checked").val();
                if (ShippingCargoType === "ShippingCargoTypeOthers") {
                    $("#ShippingagencyCargoType").show();
                    $("#ShippingagencyCargoType").attr("required", true);
                } else {
                    $("#ShippingagencyCargoType").hide();
                    $.each($(".ShippingCargoType:checked"), function () {
                        ShippingCargoTypelist.push($(this).val());
                    });
                    $("#ShippingagencyCargoType").val(ShippingCargoTypelist.join(", "));
                }
            });












            $('#addbtn').click(function (e) {
                e.preventDefault();

                if (agencyID === 2) {
                    var LogisticsLineOfBusiness = $("#LogisticsLineOfBusiness").val();
                    if (LogisticsLineOfBusiness === "") {
                        alert("Please check/select line of business");
                        return false;
                    }
                }
                else if (agencyID === 3) {
                    var portoffdockLineOfBusiness = $("#portoffdockLineOfBusiness").val();
                    var StatusOfTerminal = $("#StatusOfTerminal").val();
                    var portoffdockCargoType = $("#portoffdockCargoType").val();
                    if (portoffdockLineOfBusiness === "") {
                        alert("Please check/select Line of Business");
                        return false;
                    } else if (StatusOfTerminal === "") {
                        alert("Please check/select Status of Terminal");
                        return false;
                    } else if (portoffdockCargoType === "") {
                        alert("Please check/select Cargo Type");
                        return false;
                    }

                }
                else if (agencyID === 4) {
                    var ShippingagencyLineOfBusiness = $("#ShippingagencyLineOfBusiness").val();
                    var ShippingagencyCargoType = $("#ShippingagencyCargoType").val();
                    if (ShippingagencyLineOfBusiness === "") {
                        alert("Please check/select Line of Business");
                        return false;
                    } else if (ShippingagencyCargoType === "") {
                        alert("Please check/select Cargo Type");
                        return false;
                    }
                }


                if ($("#formid").valid()) {
                    var r = confirm("Are you sure you want to Proceed ?");
                    if (r == true) {
                        $(".loadingImage").show();
                        debugger;
                        var Terminals = [];

                        var TerminalName = document.getElementsByName('txtTerminalName[]');
                        var TerminalLocation = document.getElementsByName('txtTerminalLocation[]');

                        for (var i = 0; i < TerminalName.length; i++) {
                            debugger;
                            //var tks = TankId[i] == "" || TankId[i] == null ? 0 : TankId[i].value.trim();

                            Terminals.push({
                                "TerminalName": TerminalName[i].value.trim(),
                                "TerminalLocation": TerminalLocation[i].value.trim(),
                            });

                        }

                        $.post($("#formid").attr('action'), $("#formid").serialize() + '&' + $.param({ "MyTerminals": Terminals })).done(function (data) {

                           
                            var status = data.Status;
                            $(".loadingImage").show();

                            if (status === "failed") {
                                $(".loadingImage").hide();
                                alert("System Error Occured, Please try again Later");
                            }
                            else {
                                alert("Reference Number " + data.applicationId + " Generated For this Application");
                                $(".loadingImage").hide();
                                window.location.href = getContextPath() + "/ChargeSummary?ApplicationId=" + data.applicationId;
                            }

                        }).fail(function (data) {
                            $(".loadingImage").hide();
                            alert('Network Communication Error, Restore Connection and Try again');
                        }).always(function (data) {
                            $(".loadingImage").hide();
                        });
                    }
                }
            });


            $('#DateofEstablishment').datepicker({
                format: 'dd/mm/yyyy',
                autoclose: true
            });


        });




    </script>


}
